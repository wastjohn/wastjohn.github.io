<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Will St.&nbsp;John">
<meta name="dcterms.date" content="2025-10-31">

<title>PHYS 481 - Quantum Mechanics – Will St.&nbsp;John</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3692fb4b4745519386f59a8d5352662e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-a3d30b477d13debbc8888286ac5bac8f.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Will St.&nbsp;John</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Courses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-courses">    
        <li>
    <a class="dropdown-item" href="../../courses/honors/index.html">
 <span class="dropdown-text">Honors</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../courses/astrophysics/index.html">
 <span class="dropdown-text">Astrophysics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../courses/ML/index.html">
 <span class="dropdown-text">Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../courses/topology/index.html">
 <span class="dropdown-text">Topology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../courses/quantum/index.html">
 <span class="dropdown-text">Quantum</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../courses/compGeom/index.html">
 <span class="dropdown-text">Computational Geometry</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-1---an-expanding-infinite-square-well" id="toc-problem-1---an-expanding-infinite-square-well" class="nav-link active" data-scroll-target="#problem-1---an-expanding-infinite-square-well">Problem 1 - An expanding infinite square well</a></li>
  <li><a href="#problem-2---scattering-by-a-potential-well" id="toc-problem-2---scattering-by-a-potential-well" class="nav-link" data-scroll-target="#problem-2---scattering-by-a-potential-well">Problem 2 - Scattering by a potential well</a></li>
  <li><a href="#problem-3---scattering-by-a-potential-barrier" id="toc-problem-3---scattering-by-a-potential-barrier" class="nav-link" data-scroll-target="#problem-3---scattering-by-a-potential-barrier">Problem 3 - Scattering by a potential barrier</a></li>
  <li><a href="#problem-4---combinations-of-two-potentials" id="toc-problem-4---combinations-of-two-potentials" class="nav-link" data-scroll-target="#problem-4---combinations-of-two-potentials">Problem 4 - Combinations of two potentials</a></li>
  <li><a href="#problem-5---step-potential" id="toc-problem-5---step-potential" class="nav-link" data-scroll-target="#problem-5---step-potential">Problem 5 - Step potential</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PHYS 481 - Quantum Mechanics</h1>
<p class="subtitle lead">Assignment 04</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Will St.&nbsp;John </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 31, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="problem-1---an-expanding-infinite-square-well" class="level1">
<h1>Problem 1 - An expanding infinite square well</h1>
<p>Consider a particle of mass <span class="math inline">\(m\)</span> in an infinite square well, that extends from 0 to <span class="math inline">\(a\)</span>. Assume that the particle is in the ground state of the square well for <span class="math inline">\(t &lt; 0\)</span>. At <span class="math inline">\(t = 0\)</span> the size of the square well is suddenly expanded, so that it extends from 0 to <span class="math inline">\(2a\)</span> leaving the wave function of the state undisturbed.</p>
<ol type="a">
<li>Write down the wave function <span class="math inline">\(\Psi(x,t = 0)\)</span> in the new larger well (Think carefully about the different regions in the new well).</li>
<li>The wave function <span class="math inline">\(\Psi(x,t = 0)\)</span> can be expanded as a linear combination of the stationary states, <span class="math inline">\(\chi_n(x)\)</span>, of the new larger well, i.e.&nbsp;<span class="math inline">\(\Psi(x,t = 0) = \sum_{n=1}^{\infty} c_n\chi_n(x)\)</span>. Determine a formula for <span class="math inline">\(c_n\)</span> and show by summing the first terms that the sum over <span class="math inline">\(|c_n|^2\)</span> is approaching 1. Does this make sense? Explain.</li>
<li>Assume that the energy of the particle is measured at some time <span class="math inline">\(t &gt; 0\)</span>. What is the expectation value <span class="math inline">\(\left&lt;E\right&gt;\)</span> of the energy? What is the probability that the energy of the first excited state <span class="math inline">\((n = 2)\)</span> of the new well is measured</li>
<li>Calculate the smallest period of time, <span class="math inline">\(\tau &gt; 0\)</span>, at which <span class="math inline">\(\Psi(x,\tau) = \Psi(x,t = 0)\)</span>.</li>
</ol>
<blockquote class="blockquote">
<p><strong>Response</strong>: Since the wavefunction has not changed between <span class="math inline">\(t&lt;0\)</span> and <span class="math inline">\(t=0\)</span>, the wavefunction at <span class="math inline">\(t=0\)</span> is identical to what is was for <span class="math inline">\(t&lt;0\)</span>, except now the well has expanded so there is a region inside the box where there is no wavefunction.</p>
<p><span class="math display">\[\Psi(x,0) = \cases{\sqrt{\frac{2}{a}\sin\frac{\pi}{a}x} \quad x\in(0,a) \\ 0 \quad x\in(a,2a) \\ 0 \quad \text{else}}\]</span></p>
<p>Since <span class="math inline">\(\Psi(x,0)\)</span> can be written as a linear combination of the stationary states, <span class="math inline">\(\chi_n(x)\)</span>, of the new larger well, we can write <span class="math inline">\(\Psi(x,0)\)</span> as follows</p>
<p><span class="math display">\[\Psi(x,0) = \sum_{n=1}^{\infty}c_n\chi_n\]</span></p>
<p>where <span class="math display">\[\chi_n = \sqrt{\frac{1}{a}}\sin\frac{n\pi}{2a}x, \quad x\in(0,2a)\]</span></p>
<p>and <span class="math display">\[\begin{align}c_n &amp;= \sqrt{\frac{2}{a}}\int\sin\frac{n\pi x}{a}\Psi(x,0)dx \\ &amp;= \sqrt{\frac{1}{a}}\int_0^a\sin\frac{n\pi x}{a}\sqrt{\frac{2}{a}}\sin\frac{\pi x}{a}dx \\ &amp;= \frac{4\sqrt{2}\sin\frac{n\pi}{2}}{4\pi-n^2\pi}\end{align}\]</span></p>
<p>Note that we get an issue when <span class="math inline">\(n=2\)</span> with this solution, however, if we rewrite the integrand using the product to sum formula</p>
<p><span class="math display">\[\sin A\sin B = \frac{1}{2}\left(\cos(A-B) - \cos(A+B)\right)\]</span></p>
<p>Applied to our case <span class="math inline">\(n=2\)</span>, we get the following integral for <span class="math inline">\(c_2\)</span></p>
<p><span class="math display">\[c_2 = \int_0^a\frac{\sqrt{2}}{2a}\left(\cos\left(\frac{2\pi x}{2a} - \frac{\pi x}{a}\right) - \cos\left(\frac{2\pi x}{2a} + \frac{\pi x}{a}\right)\right)dx = \frac{1}{\sqrt{2}}\]</span></p>
<p>If we sum over the first 5 terms in the sequence <span class="math inline">\(|c_n|^2\)</span> using our formula for <span class="math inline">\(c_n\)</span> for all <span class="math inline">\(n\not=2\)</span> and use <span class="math inline">\(\frac{1}{\sqrt{2}}\)</span> for <span class="math inline">\(c_2\)</span>, then we get</p>
<p><span class="math display">\[\sum_{n=1}^{5}|c_n|^2 = 0.997296\]</span></p>
<p>If we assume that the energy is measured at some time <span class="math inline">\(t&gt;0\)</span>, the expectation value is given by</p>
<p><span class="math display">\[\begin{align} \left&lt;H\right&gt; &amp;= \sum_{n=1}^{\infty}|c_n|^2 E_n \\ &amp;= \frac{4\hbar^2}{ma^2}\sum_{n=1}^{\infty}\frac{\sin^2\left(\frac{n\pi}{2}\right)n^2}{(4-n)^2} \end{align}\]</span></p>
<p>For <span class="math inline">\(c=2\)</span> we cannot evaluate using this formula directly. Thankfully, we already found a solution for <span class="math inline">\(c_2\)</span> directly, and since the probability that energy of a particle in the n-th state is equal to <span class="math inline">\(|c_n|^2\)</span>, we have a probability of 0.5 that the energy of first excited state (n=2) of the new well is measured.</p>
<p>For the final problem, we get <span class="math inline">\(\Psi(x,\tau) = \Psi(x,t = 0)\)</span>, explicity <span class="math display">\[\sum_{n=1}^{\infty}c_n\chi_n = \sum_{n=1}^{\infty}c_n\chi_n e^{-iE_n\tau/\hbar},\]</span> when <span class="math display">\[e^{-iE_n\tau/\hbar} = 1 = e^{-i2\pi n}.\]</span> This corresponds to <span class="math display">\[\frac{E_n\tau}{\hbar} = 2\pi n\]</span> and when <span class="math inline">\(n=1\)</span>, <span class="math display">\[\frac{\pi^2\hbar^2\tau}{8ma^2\hbar} = 2\pi\]</span> and <span class="math display">\[\tau = \frac{16ma^2}{\pi\hbar}\]</span></p>
</blockquote>
</section>
<section id="problem-2---scattering-by-a-potential-well" class="level1">
<h1>Problem 2 - Scattering by a potential well</h1>
<p>Consider the case of a particle beam which comes in from the left with <span class="math inline">\(E &gt; 0\)</span> and scatters of the potential</p>
<p><span class="math display">\[V(x) = \cases{0, &amp; x&lt;0 \\ -V_0, &amp; 0&lt;x&lt;a \\ 0, &amp; a&lt;x}\]</span></p>
<p>with <span class="math inline">\(V_0&gt;0\)</span> (note the minus sign in front of $V_0 in the formula).</p>
<ol type="a">
<li>Write down the wave function in each region and give the wave numbers in your general solutions as functions of <span class="math inline">\(E\)</span> and <span class="math inline">\(V_0\)</span>.</li>
<li>Write down the appropriate boundary conditions using the wave functions you have determined and justify any terms in your general solutions you set to zero.</li>
<li>The transmission coefficient for particles coming from the left to be transmitted to <span class="math inline">\(x\to\infty\)</span> is given by <span class="math display">\[T^{-1} = 1 + \frac{1}{4(E/V_0)(1+E/V_0)}\sin^2\left(\frac{a}{\hbar}\sqrt{2m(V_0 + E)}\right)\]</span> Determine <span class="math inline">\(T\)</span> for the limiting cases <span class="math inline">\(E\to 0\)</span> and <span class="math inline">\(E\to\infty\)</span>.</li>
<li>Consider the case where <span class="math inline">\(E=V_0\)</span>. Determine <span class="math inline">\(T\)</span> at three different values of the parameters: <span class="math inline">\(V_0\to0\)</span>, <span class="math inline">\(a^2mV_0/\hbar^2 = \pi^2/16\)</span>, <span class="math inline">\(a^2mV_0/\hbar^2 = \pi^2/4\)</span>. How does this compare to your classical expectation?</li>
</ol>
<blockquote class="blockquote">
<p><strong>Response</strong>: For part a), we can label our regions as <span class="math inline">\(I\)</span>, <span class="math inline">\(II\)</span>, and <span class="math inline">\(III\)</span> corresponding to <span class="math inline">\(x&lt;0\)</span>, <span class="math inline">\(0&lt;x&lt;a\)</span>, and <span class="math inline">\(x&gt;a\)</span>. Regions <span class="math inline">\(I\)</span> and <span class="math inline">\(III\)</span> are both free particles, so they have the general solutions of</p>
<p><span class="math display">\[\begin{align}\psi_I &amp;= Ae^{ikx} + Be^{-ikx} \\ \psi_{II} &amp;= Fe^{ikx} + Ge^{-ikx} \\ k&amp;=\sqrt{2mE}/\hbar\end{align}\]</span></p>
<p>Solving for the TISE in region <span class="math inline">\(II\)</span></p>
<p><span class="math display">\[\begin{align} -\frac{\hbar}{2m}\frac{d\psi}{dx} - V_0\psi &amp;= E \\ \frac{d\psi}{dx} &amp;= -\frac{2m(E+V_0)}{\hbar^2}\psi \\ \frac{d\psi}{dx} &amp;= -l^2\psi, \quad l= \frac{\sqrt{2m(E+V_0)}}{\hbar}\end{align}\]</span></p>
<p>gives the following solution</p>
<p><span class="math display">\[\psi_{II} = C\cos lx + D\sin lx\]</span></p>
<p>Setting up our boundary conditions in part b), we have no infinite potentials, so we get two boundary conditions from each boundary. Additionally, we have the physical condition that there are no particles coming in from the right. The corresponding five boundary conditions are the following:</p>
<p><span class="math display">\[\begin{align} (\text{no particles incident from right}) &amp;\longrightarrow G = 0\\ \psi_I\big|_{x=0} = \psi_{II}\big|_{x=0} &amp;\longrightarrow A + B = C \\ \psi_{II}\big|_{x=a} = \psi_{III}\big|_{x=a} &amp;\longrightarrow C\cos la + D\sin la = F\cos ka + iF\sin ka  \\ \psi_I'\big|_{x=0} = \psi_{II}'\big|_{x=0} &amp;\longrightarrow ik(A-B) = lD \\ \psi_{II}'\big|_{x=a} = \psi_{III}'\big|_{x=a} &amp;\longrightarrow -lC\sin la + lD\cos la = ikFe^{ika}\end{align}\]</span></p>
<p>For part c), using the equation for the transmission coefficient provided, we can see that in the case when <span class="math inline">\(E\to 0\)</span>, the denominator of the second term goes to zero, meaning <span class="math inline">\(T^{-1}\)</span> goes like <span class="math inline">\(1 + \infty \approx \infty\)</span>, so <span class="math inline">\(T\)</span> goes zero. This matches our intuition that a particle with no energy should not be able to get through a barrier. Similarly, when <span class="math inline">\(E\to\infty\)</span>, the denominator of the second term blows up and the second term drops away, leaving a transmission coefficient of <span class="math inline">\(T=1\)</span>. This also matches our intuition that a particle with infinite energy should be able break through any barrier in its way.</p>
<p>For part d), when <span class="math inline">\(E=V_0\)</span>, we get the slightly simplified equation for the transmission coefficient</p>
<p><span class="math display">\[T^{-1} = 1 + \frac{1}{8}\sin^2\left(\frac{2a}{\hbar}\sqrt{mV_0}\right)\]</span></p>
<p>When <span class="math inline">\(V_0\to0\)</span>, we get <span class="math display">\[T^{-1}=1 + \frac{1}{8}\sin^2(0) = 1\]</span> which corresponds to a transmission coefficient of <span class="math inline">\(T=1\)</span>. This makes sense classically as when we reduce any potentials to zero, then the particle is free to move wherever it likes.</p>
<p>When <span class="math display">\[a^2mV_0/\hbar^2 = \pi^2/16,\]</span> we can make the following relation that <span class="math display">\[\frac{a}{\hbar}\sqrt{2mV_0} = \frac{\pi}{4}.\]</span> This corresponds to an inverse transmission coefficient of <span class="math display">\[T^{-1} = 1 + \frac{1}{8}\sin^2\left(\frac{\pi}{2}\right) = 1 + \frac{1}{8} = \frac{9}{8}\]</span> or a transmission coefficent of <span class="math display">\[T = \frac{8}{9}\]</span></p>
<p>When <span class="math display">\[a^2mV_0/\hbar^2 = \pi^2/4,\]</span> we can make the following relation that <span class="math display">\[\frac{a}{\hbar}\sqrt{2mV_0} = \frac{\pi}{2}.\]</span> This corresponds to an inverse transmission coefficient of <span class="math display">\[T^{-1} = 1 + \frac{1}{8}\sin^2(\pi) = 1 + 0 = 1\]</span> or a transmission coefficent of <span class="math display">\[T = 1\]</span>.</p>
</blockquote>
</section>
<section id="problem-3---scattering-by-a-potential-barrier" class="level1">
<h1>Problem 3 - Scattering by a potential barrier</h1>
<p>Consider now a potential with a barrier of height <span class="math inline">\(V_0\)</span></p>
<p><span class="math display">\[V(x) = \cases{0, &amp; x&lt;0 \\ V_0, &amp; 0&lt;x&lt;a \\ 0, &amp; a&lt;x}\]</span></p>
<ol type="a">
<li>Adapt the results from the previous problem to demonstrate that for <span class="math inline">\(0&lt;E&lt;V_0\)</span> the transmission coefficient is given by <span class="math display">\[T^{-1} = 1 + \frac{1}{4(E/V_0)(1-E/V_0)}\sinh^2\left(\frac{a}{\hbar}\sqrt{2m(V_0 - E)}\right)\]</span> To do this, turn the barrier downside up by replacing <span class="math inline">\(V_0\)</span> with <span class="math inline">\(−V_0\)</span> in that formula, and obtain an expression for <span class="math inline">\(T^{−1}\)</span> where everything is real. It may help to know that <span class="math inline">\(\sinh(ix) = i\sin x\)</span>.</li>
<li>Consider this system as a model of a baseball being thrown at a wall. A baseball has a mass of about 150 g, and we take it to be thrown at 40 m/s (near 90 mph). Assume that the wall is 0.1 m thick, and let’s make the approximation that the ball would have to be 5 times as energetic to punch through the wall classically, so <span class="math inline">\(V_0 = 5E\)</span> with <span class="math inline">\(E\)</span> determined by the quantities above. What is the order of magnitude for <span class="math inline">\(T\)</span>? Let’s put this into perspective: if you keep trying, tossing a baseball at the wall once per second, roughly how long do you have to wait until it ”pops through” the wall quantum mechanically? Give your answer in seconds, and also in ages of the Universe (current models show the Universe to be about 13.7 billion years old), and comment on your results</li>
</ol>
<blockquote class="blockquote">
<p><strong>Response</strong>: Starting with the transmission coefficient given in the previous problem</p>
<p><span class="math display">\[T^{-1} = 1 + \frac{1}{4(E/V_0)(1+E/V_0)}\sin^2\left(\frac{a}{\hbar}\sqrt{2m(V_0 + E)}\right)\]</span></p>
<p>if we set <span class="math inline">\(V_0 = -V_0\)</span>, we get the following (note that <span class="math inline">\(E&lt;V_0\)</span>)</p>
<p><span class="math display">\[T^{-1} = 1 + \frac{1}{-4(E/V_0)(1-E/V_0)}\sin^2\left(i\frac{a}{\hbar}\sqrt{2m(V_0 - E)}\right)\]</span></p>
<p>If we recognize <span class="math inline">\(\sinh(ix) = i\sin(x)\)</span>, or, more usefully, <span class="math inline">\(\sinh^2(ix) = -sin^2(x)\)</span> (and the <span class="math inline">\(sinh^2(x)\)</span> is even), we get the following result</p>
<p><span class="math display">\[T^{-1} = 1 + \frac{1}{4(E/V_0)(1-E/V_0)}\sinh^2\left(\frac{a}{\hbar}\sqrt{2m(V_0 - E)}\right)\]</span></p>
<p>Now exploring the baseball question, if we consider all of the energy to be kinetic <span class="math inline">\(\left(E = \frac{1}{2}mv^2\right)\)</span>, <span class="math inline">\(m=0.15\)</span> kg, <span class="math inline">\(v=40\)</span> m/s, <span class="math inline">\(a=0.1\)</span> m, and <span class="math inline">\(V_0 = 5E\)</span>, the terms inside the argument of <span class="math inline">\(\sinh^2\)</span> evaluates to <span class="math inline">\(1.1379\cdot10^{34}\)</span> and coefficient of <span class="math inline">\(\sinh^2\)</span> becomes <span class="math inline">\(\frac{5^2}{4^2}\)</span>. If we approximate <span class="math inline">\(\sinh(x)\)</span> as <span class="math inline">\(\frac{e^x}{2}\)</span>, then <span class="math inline">\(\sinh^2(x) \approx \frac{e^2x}{4}\)</span> making our equation <span class="math display">\[T^{-1} \approx 1 + \frac{25}{64}e^{2.2758\cdot10^{34}}\]</span></p>
<p>This implies <span class="math display">\[T\approx \frac{64}{64 + 25 e^{2.2758\cdot10^{34}}}.\]</span> Note that 64 and 25 are insignificant in comparison to the exponential term, so the overall transmission goes like</p>
<p><span class="math display">\[T\approx e^{-2.2758\cdot10^{34}}\]</span></p>
<p>To put this into perspective, if we were to toss our baseball at the wall once every second, we would expect to find it on the other side of the wall after <span class="math inline">\(\approx e^{-2.2758\cdot10^{34}}\)</span> seconds or</p>
<p><span class="math display">\[\frac{t_{thru}}{t_{universe}} = \frac{e^{-2.2758\cdot10^{34}}\text{ s}}{4.320\cdot10^{17} \text{ s}} \xrightarrow{\ln} \frac{2.2758\cdot10^{34}}{\ln 4.320\cdot10^{17}} = 5.604\cdot10^{32}\xrightarrow{\exp} e^{5.604\cdot10^{32}}\text{ ages of the universe}\]</span></p>
</blockquote>
</section>
<section id="problem-4---combinations-of-two-potentials" class="level1">
<h1>Problem 4 - Combinations of two potentials</h1>
<p>Write down the form of the wave function in each region that represents the following physical system, give the wave numbers in your general soluton as functions of <span class="math inline">\(E\)</span> and <span class="math inline">\(V_0\)</span>, and justify any terms you set to zero assuming a particle with <span class="math inline">\(0&lt;E&lt;V_0\)</span> is incident from the <em>right</em>. Write down the appropriate boundary conditions using the wave functions you have determined. You do <em>not</em> have to solve for the parameters.</p>
<p><img src="PS4Q4.png" class="img-fluid"></p>
<blockquote class="blockquote">
<p><strong>Response</strong>: We have four regions in this system; <span class="math inline">\(b\)</span> to <span class="math inline">\(\infty\)</span>, <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span>, 0 to <span class="math inline">\(a\)</span>, and <span class="math inline">\(-\infty\)</span> to 0; which we will label as <span class="math inline">\(I\)</span>, <span class="math inline">\(II\)</span>, <span class="math inline">\(III\)</span>, and <span class="math inline">\(IV\)</span>, respectively.</p>
<p>In <span class="math inline">\(I\)</span>, we have a free particle, thus, the solution to the TISE takes the form <span class="math display">\[\psi_I = Ae^{ikx} + Be^{-ikx}, \quad k = \sqrt{2mE}/\hbar\]</span>. We have a similar solution for regions <span class="math inline">\(III\)</span> and <span class="math inline">\(IV\)</span>, which are also free particles. <span class="math display">\[\begin{align}\psi_{III} &amp;= Fe^{ikx} + Ge^{-ikx} \\ \psi_{IV} &amp;= He^{ikx} + Je^{-ikx} \end{align}\]</span></p>
<p>In <span class="math inline">\(II\)</span>, we have scattering by a potential barrier. Applying our TISE for this region,</p>
<p><span class="math display">\[\begin{align} -\frac{\hbar}{2m}\frac{d\psi}{dx} + V_0\psi &amp;= E \\ \frac{d\psi}{dx} &amp;= \frac{2m(V_0-E)}{\hbar^2}\psi \\ \frac{d\psi}{dx} &amp;= l^2\psi, \quad l= \frac{\sqrt{2m(V_0 - E)}}{\hbar}\end{align}\]</span></p>
<p>which has a solution</p>
<p><span class="math display">\[\psi_{II} = Ce^{lx} + De^{-lx}, \quad l= \frac{\sqrt{2m(V_0 - E)}}{\hbar}\]</span></p>
<p>Putting our solutions together, we get the following forms in each region for our wavefunctions.</p>
<p><span class="math display">\[\begin{align}\psi_I &amp;= Ae^{ikx} + Be^{-ikx} \\ \psi_{II} &amp;= Ce^{lx} + De^{-lx} \\ \psi_{III} &amp;= Fe^{ikx} + Ge^{-ikx} \\ \psi_{IV} &amp;= He^{ikx} + Je^{-ikx} \\ \\ k &amp;= \sqrt{2mE}/\hbar \\ l&amp;= \frac{\sqrt{2m(V_0 - E)}}{\hbar}\end{align}\]</span></p>
<p>Applying our boundary conditions, we can say generally that <span class="math inline">\(\psi\)</span> is continuous and <span class="math inline">\(d\psi/dx\)</span> is continuous except in infinite potentials.</p>
<p>Applying these general statments to our system, we can derive our boundary conditions.</p>
<p>We get two boundary conditions between <span class="math inline">\(I\)</span> and <span class="math inline">\(II\)</span>. Specifically:</p>
<p><span class="math display">\[\begin{align} Ae^{ikb} + Be^{-ikb} &amp;= Ce^{lb} + De^{-lb} \\ ikAe^{ikb} - ikBe^{-ikb} &amp;= lCe^{lb} - lDe^{-lb}\end{align}\]</span></p>
<p>Similarly for regions <span class="math inline">\(II\)</span> and <span class="math inline">\(III\)</span>:</p>
<p><span class="math display">\[\begin{align} Ce^{la} + De^{-la} &amp;= Fe^{ika} + Ge^{-ika}\\ lCe^{la} - lDe^{-la} &amp;= ikFe^{ika} - ikGe^{-ika}\end{align}\]</span></p>
<p>For regions <span class="math inline">\(III\)</span> and <span class="math inline">\(IV\)</span>, we have an infinite potential, so the spatial derivative of <span class="math inline">\(\psi\)</span> is not continuous at <span class="math inline">\(x=0\)</span>, but we gain the physical constraint that there are no incident particles from the left, resulting in the following boundary conditions.</p>
<p><span class="math display">\[\begin{align}H &amp;= 0 \\ F + G &amp;= J\end{align}\]</span></p>
</blockquote>
</section>
<section id="problem-5---step-potential" class="level1">
<h1>Problem 5 - Step potential</h1>
<p>Consider the “step” potential:</p>
<p><span class="math display">\[V(x) = \cases{0 \hspace{1cm} x \leq 0 \\ V_0 \hspace{1cm} x &gt; 0}\]</span></p>
<ol type="a">
<li>Calculate the reflection coefficient, for the case <span class="math inline">\(E &lt; V_0\)</span> , and comment on the answer.</li>
<li>Calculate the reflection coefficient for the case <span class="math inline">\(E &gt; V_0\)</span>.</li>
<li>For a potential (such as this one) that does not go back to zero to the right of the barrier, the transmission coefficient is not simply <span class="math inline">\(|F|^2/|A|^2\)</span> (with <span class="math inline">\(A\)</span> the incident amplitude and <span class="math inline">\(F\)</span> the transmitted amplitude), because the transmitted wave travels at a different speed. Show that <span class="math display">\[T = \sqrt{\frac{E-V_0}{E}}\frac{|F|^2}{|A|^2}\]</span> for <span class="math inline">\(E&gt;V_0\)</span></li>
<li>For <span class="math inline">\(E &gt;V_0\)</span>, calculate the transmission coefficient for the step potential and check that <span class="math display">\[R+T = 1\]</span></li>
</ol>
<blockquote class="blockquote">
<p><strong>Response</strong>: For the case <span class="math inline">\(E &lt; V_0\)</span>, we have two regions (<span class="math inline">\(I:x\leq0\)</span>, and <span class="math inline">\(II:x&gt;0\)</span>). Region <span class="math inline">\(I\)</span> is a free particle so it has the general solution <span class="math display">\[\psi_{I} = Ae^{ikx} + Be^{-ikx}, \quad k = \sqrt{2mE}/\hbar.\]</span></p>
<p>The TISE in region <span class="math inline">\(II\)</span> gives the differential equation</p>
<p><span class="math display">\[\frac{d^2\psi}{dx^2} = l^2\psi, \quad l = \sqrt{2m(V_0-E)}/\hbar\]</span></p>
<p>which has a general solution of</p>
<p><span class="math display">\[\psi_{II} = De^{lx} + Ce^{-lx}, \quad l = \sqrt{2m(V_0-E)}/\hbar\]</span></p>
<p>Looking at boundary conditions, none of the potentials are infinite, so we have two boundary conditions and a physical condition that <span class="math inline">\(D=0\)</span> as the first exponential in <span class="math inline">\(\psi_{II}\)</span> blows up as <span class="math inline">\(x\to\infty\)</span>. Thus, the boundary conditions become:</p>
<p><span class="math display">\[\begin{align}\psi_{I}\big|_{x=0} &amp;= \psi_{I}\big|_{x=0} \\ A + B &amp;= C \\ \\ \psi_{I}'\big|_{x=0} &amp;= \psi_{I}'\big|_{x=0} \\ ik(A-B) &amp;= -lC\end{align} \]</span></p>
<p>As <span class="math inline">\(R = \frac{|B|^2}{|A^2|}\)</span>, we can take our two boundary conditions and solve for <span class="math inline">\(B/A\)</span>.</p>
<p><span class="math display">\[\begin{align}ik(A-B) &amp;= - l(A+B) \\ ikA - ikB &amp;= -lA -lB \\ (ik+l)A &amp;= (-ik-l)B \\ \frac{B}{A} &amp;= \frac{ik+l}{-ik-l} \end{align}\]</span></p>
<p>Then square our result to get <span class="math inline">\(R\)</span></p>
<p><span class="math display">\[\begin{align} R &amp;= \frac{|B|^2}{|A|^2} \\ &amp;= \frac{(ik+l)(-ik+l)}{(-ik-l)(ik-l)} \\ &amp;= \frac{k^2 + l^2}{l^2 + k^2} \\ &amp;= 1\end{align}\]</span></p>
<p>So in the case that our energy is less than the potential, an incident particle is 100% reflected in a step potential.</p>
<p>Looking at the other case, when <span class="math inline">\(E&gt;V_0\)</span>, we get the same solution in region <span class="math inline">\(I\)</span>,</p>
<p><span class="math display">\[\psi_{I} = Ae^{ikx} + Be^{-ikx}, \quad k = \sqrt{2mE}/\hbar\]</span></p>
<p>but region <span class="math inline">\(II\)</span> is now described by the slightly modified differential equation</p>
<p><span class="math display">\[\frac{d^2\psi}{dx^2} = -l^2\psi, \quad l = \sqrt{2m(E-V_0)}/\hbar\]</span></p>
<p>which has general solution of <span class="math display">\[\psi_{II} = Ce^{ilx} + De^{-ilx}\]</span>.</p>
<p>Looking at physical conditions, we can see that <span class="math inline">\(D\)</span> must be zero since we have no particles incident from the right. The resulting boundary conditions are</p>
<p><span class="math display">\[\psi_{I}\big|_{x=0} = \psi_{II}\big|_{x=0} \longrightarrow A + B = C\]</span></p>
<p>and</p>
<p><span class="math display">\[\psi_{I}'\big|_{x=0} = \psi_{II}'\big|_{x=0} \longrightarrow k(A-B) = lC\]</span></p>
<p>Solving this system of equations for <span class="math inline">\(B/A\)</span> gives</p>
<p><span class="math display">\[\frac{B}{A} = \frac{k-l}{l+k}\]</span></p>
<p>Solving for <span class="math inline">\(R\)</span> gives</p>
<p><span class="math display">\[\begin{align}R &amp;= \frac{|B|^2}{|A|^2} \\ &amp;= \frac{(k-l)^2}{(l+k)^2} \\ &amp;= \frac{(k-l)^2}{(l+k)^2} \cdot\frac{(k-l)^2}{(k-l)^2} \\ &amp;= \frac{(k-l)^4}{(k^2-l^2)^2}\end{align}\]</span></p>
<p>Here we will note that</p>
<p><span class="math display">\[k-l = \frac{\sqrt{2}m}{\hbar}(\sqrt{E}-\sqrt{E-V_0})\]</span></p>
<p>and</p>
<p><span class="math display">\[k^2 - l^2 = \frac{2m}{\hbar}V_0\]</span></p>
<p>Returning to our solution for <span class="math inline">\(R\)</span></p>
<p><span class="math display">\[\begin{align}R &amp;= \frac{(k-l)^4}{(k^2-l^2)^2} \\ &amp;= \frac{\left(\frac{\sqrt{2}m}{\hbar}(\sqrt{E}-\sqrt{E-V_0})\right)^4}{\left(\frac{2m}{\hbar^2}\right)^2V_0^2} \\ &amp;= \frac{(\sqrt{E} - \sqrt{E-V_0})^4}{V_0^2}\end{align}\]</span></p>
<p>Moving on to part c) now, if the potential does not go back to zero to the right of the barrier, then the waves in the two regions are going to be traveling at different speeds, so we need to derive a new relation for the transmitted wave.</p>
<p>Remembering our probability current <span class="math inline">\(J\)</span>, that describes the rate at which probability is flowing past a point, we can see that the transmission coefficient should be proportional to the transmitted probability current by the incident probability current.</p>
<p><span class="math display">\[T = \frac{J_{transmitted}}{J_{incident}}\]</span></p>
<p>Now we just need a relationship for the probability current for a free particle, since that is what describes our system. Thankfully, Problem 2.18 is exactly this problem.</p>
<p>If we start with our definition of <span class="math inline">\(J\)</span></p>
<p><span class="math display">\[J = \frac{i\hbar}{2m}\left(\Psi\frac{\partial\Psi^*}{\partial x} - \Psi^*\frac{\partial\Psi}{\partial x}\right)\]</span></p>
<p>and assume a free particle, then we have a wavefunction like</p>
<p><span class="math display">\[\Psi_k(x,t) = Ae^{i\left(kx-\frac{\hbar k^2}{2m}t\right)}\]</span></p>
<p>where</p>
<p><span class="math display">\[k = \pm \frac{\sqrt{2mE}}{\hbar},\quad k&gt;0\implies \text{ right moving}, \quad k&lt;0\implies \text{ left moving}\]</span></p>
<p>When we substitute our wavefunction into our defintion of <span class="math inline">\(J\)</span>, we get</p>
<p><span class="math display">\[\begin{align} J &amp;= \frac{i\hbar}{2m}\left(\Psi\frac{\partial\Psi^*}{\partial x} - \Psi^*\frac{\partial\Psi}{\partial x}\right) \\ &amp;= \frac{i\hbar}{2m}\left(\Psi(-ik|A^2|)\Psi^* - \Psi^*(ik|A|^2)\Psi\right) \\ &amp;= \frac{i\hbar}{2m}\left(-2ik|A^2|\right) \\ &amp;= \frac{\hbar k}{m}|A^2|\end{align}\]</span></p>
<p>and if <span class="math inline">\(k&gt;0\implies J&gt;0\implies \text{ probability flows right}\)</span> and if <span class="math inline">\(k&lt;0\implies J&lt;0\implies \text{ probability flows left}\)</span>.</p>
<p>Using this solution, we can derive our equation for the transmittion coefficient of our original system.</p>
<p><span class="math display">\[\begin{align}T &amp;= \frac{J_{transmitted}}{J_{incident}} \\ &amp;= \frac{\frac{\hbar l}{m}|C|^2}{\frac{\hbar k}{m}|A|^2} \\ &amp;= \frac{l}{k}\frac{|C|^2}{|A|^2} \\ &amp;=\frac{\frac{\sqrt{2m(E-V_0)}}{\hbar}}{\frac{\sqrt{2mE}}{\hbar}}\frac{|C|^2}{|A|^2} \\ &amp;= \sqrt{\frac{E-V_0}{E}}\frac{|C|^2}{|A|^2}\end{align}\]</span></p>
<p>Verifying <span class="math inline">\(R + T = 1\)</span>, we first need to determine <span class="math inline">\(C/A\)</span></p>
<p><span class="math display">\[\begin{align}k(A-B) &amp;= lC \\ k(2A - C) &amp;= lC \\ 2kA &amp;= C(l + k) \\ \frac{C}{A} &amp;= \frac{2k}{l+k}\end{align}\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[\begin{align}R + T &amp;= \frac{(k-l)^2}{(l+k)^2} + \frac{l}{k}\left(\frac{2k}{l+k}\right)^2 \\ &amp;= \frac{(k-l)^2 + 4kl}{(l+k)^2} \\ &amp;= \frac{k^2 - 2kl + l^2 +4kl}{(l+k)^2} \\ &amp;= \frac{k^2 + 2kl + l^2}{(l+k)^2} \\ &amp;= \frac{(l+k)^2}{(l+k)^2} \\ &amp;= 1\end{align}\]</span></p>
</blockquote>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>